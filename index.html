<!DOCTYPE html>
<html lang="en">

<head>
	<title>
		Test
	</title>
	<link href=
"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
			rel="stylesheet">

	<script src=
"http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"
	type="text/javascript">

	</script>

	<script src=
"https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js">
	</script>
</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col-sm-12">
				<div class="card">

					<h5 class="card-header h5 text-center">
						Test
					</h5>

					<small id="webcam-status" class="text-center"></small>
					<small id="audio-status" class="text-center"></small>

					<div class="card-body">
						<div class="booth">
							<video id="video" width="40%"
								height="40%" autoplay>
							</video>
							<div id="cam" >
								<p>cam is off</p>
							</div>
							<div id="mic">
								<p>mic is off</p>
							</div>
							<audio id="audio" autoplay></audio>
						</div></div></div></div></div></div>

	<script>
	var start3=function() 
	{
  		var x = document.getElementById("video");
  		
  		if (x.style.display === "none") 
  		{
   		 	x.style.display = "hidden";
   		 	
  		} else 
  		{
    		x.style.display = "none";
  		}
	}
	var start = function () {
			
			var video = document.getElementById('video'),
			vendorUrl = window.URL || window.webkitURL;

		if (navigator.mediaDevices.getUserMedia)
		{	
			navigator.mediaDevices.getUserMedia({ video: true }).then(function (stream) 
			{		video.style.display='inline';
					video.srcObject = stream;
					var y= document.getElementById("cam");
					y.style.display="none";
					stream.oninactive =function()
					{
						var y= document.getElementById("cam");
						y.style.display="inline";
           				 
           				 start3()
           				 start()
					}

			}).catch(function (error) {
					

					if ((error.name == 'NotAllowedError') || (error.name == 'PermissionDismissedError')){
						var small = document.getElementById("webcam-status");
						
						start();
					}

				});

		}
	}

		$(function () {
			start();
		});
	var start2 = function () {
		var audio = document.getElementById('audio'),
			vendorUrl = window.URL || window.webkitURL;
		if (navigator.mediaDevices.getUserMedia) 
		{
			navigator.mediaDevices.getUserMedia({ audio: true }).then(function (stream) 
			{
				var m= document.getElementById("mic");
				m.style.display="none";
				audio.srcObject = stream;
				stream.oninactive=function()
				{
				
					var m= document.getElementById("mic");
					m.style.display="inline";
           			start2()
           		}
           	}).catch(function (error) 
			{
				if ((error.name == 'NotAllowedError') || (error.name == 'PermissionDismissedError')){
					var small = document.getElementById("audio-status");
					
					start2();
				}
			});
		}
	}
	
		$(function () {
			start2();
		});
	</script>
</body>

</html>